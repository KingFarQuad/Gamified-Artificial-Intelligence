<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text-to-Speech Quiz Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
        };
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;700&display=swap');

        body {
            background-color: #f0f0f0; /* Light background */
            color: #333; /* Dark text color */
            font-family: 'DM Sans', sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        .dark body {
            background-color: #1a1a1a; /* Dark background */
            color: #f0f0f0; /* Light text color */
        }

        .quiz-container {
            background-color: white; /* White background */
            border-radius: 1rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 2rem;
        }

        .dark .quiz-container {
            background-color: #2d2d2d; /* Dark background for quiz container */
        }

        input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
        }

        button {
            transition: background-color 0.3s, transform 0.2s;
        }

        button:hover {
            background-color: #2563eb;
            transform: translateY(-2px);
        }

        button:disabled {
            background-color: #93c5fd;
        }

        .dark button:disabled {
            background-color: #4b5563; /* Darker background for disabled buttons in dark mode */
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 dark:text-white transition-all">
  <!-- Header -->
  <script>
    function backagain() {
        window.location.href = "./header.html";
    }
   </script>
  <header class="flex justify-between items-center p-4 bg-blue-500 dark:bg-blue-800">
    <h1 class="text-2xl font-bold">Text Generator</h1>
    <div class="flex items-center">
      <button onclick="backagain()" class="mr-4 px-4 py-2 bg-gray-300 dark:bg-gray-600 text-black dark:text-white rounded">
        Back
      </button>
      <button id="theme-toggle" class="p-2 bg-white dark:bg-gray-700 rounded-full focus:outline-none">
        <svg id="sun-icon" class="hidden dark:block" stroke="currentColor" viewBox="0 0 16 16" height="28" width="28">
          <path d="M8 0a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-1 0V.5A.5.5 0 0 1 8 0zm4.243 2.243a.5.5 0 0 1 .707 0l.707.707a.5.5 0 0 1-.707.707l-.707-.707a.5.5 0 0 1 0-.707zM16 8a.5.5 0 0 1-.5.5H15a.5.5 0 0 1 0-1h.5A.5.5 0 0 1 16 8zm-2.121 4.243a.5.5 0 0 1 0 .707l-.707.707a.5.5 0 0 1-.707-.707l.707-.707a.5.5 0 0 1 .707 0zM8 14a.5.5 0 0 1-.5.5v1a.5.5 0 0 1 1 0v-1A.5.5 0 0 1 8 14zm-5.121-2.121a.5.5 0 0 1 0 .707l-.707.707a.5.5 0 0 1-.707-.707l.707-.707a.5.5 0 0 1 .707 0zM0 8a.5.5 0 0 1 .5.5H1a.5.5 0 0 1 0-1H.5A.5.5 0 0 1 0 8zm2.121-4.243a.5.5 0 0 1 .707 0l.707.707a.5.5 0 0 1-.707.707l-.707-.707a.5.5 0 0 1 0-.707zM8 3a5 5 0 1 0 0 10 5 5 0 0 0 0-10z"/>
        </svg>
        <svg id="moon-icon" class="block dark:hidden" stroke="currentColor" viewBox="0 0 16 16" height="28" width="28">
          <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
      </button>
    </div>
  </header>
    <!-- Quiz Container -->
    <div class="quiz-container mx-auto mt-10 max-w-md">
        <h1 class="text-2xl text-center font-bold">Text-to-Speech Quiz Game</h1>
        
        <div class="level-selection text-center my-4">
            <button id="easy" class="level-btn bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded">Easy</button>
            <button id="medium" class="level-btn bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-2 px-4 rounded">Medium</button>
            <button id="hard" class="level-btn bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded">Hard</button>
        </div>

        <div id="quiz" class="text-lg font-semibold my-4 text-center"></div>

        <div class="input-container">
            <input type="text" id="answer" class="border-gray-300 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border rounded-md p-3 text-black" placeholder="Type your answer..." required>
        </div>
        
        <button id="submit" disabled class="mt-4 bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg">Submit</button>
        
        <div id="result" class="mt-6 text-center"></div>
    </div>

    <script>
        // Dark Mode Toggle Script
        const themeToggleBtn = document.getElementById('theme-toggle');
        const htmlElement = document.documentElement;
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');

        // Set initial theme based on local storage
        if (localStorage.getItem('theme') === 'dark') {
            htmlElement.classList.add('dark');
        } else {
            htmlElement.classList.remove('dark');
        }

        // Toggle theme on button click
        themeToggleBtn.addEventListener('click', () => {
            if (htmlElement.classList.contains('dark')) {
                htmlElement.classList.remove('dark');
                localStorage.setItem('theme', 'light');
            } else {
                htmlElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
            }
            sunIcon.classList.toggle('hidden');
            moonIcon.classList.toggle('hidden');
        });

        
        const quizData = {
    easy: [
        { question: "What is the capital city of the Philippines?", correct: "Manila" },
        { question: "Which planet is closest to the Sun?", correct: "Mercury" }
    ],
    medium: [
        { question: "What is the largest ocean on Earth?", correct: "Pacific" },
        { question: "Who wrote the play 'Hamlet'?", correct: "Shakespeare" }
    ],
    hard: [
        { question: "What is the square root of 64?", correct: "8" },
        { question: "What is the hardest natural substance on Earth?", correct: "Diamond" }
    ]
};

let currentQuiz = 0;
let score = 0;
let currentLevel = 'easy'; // Default level

const quizContainer = document.getElementById('quiz');
const answerInput = document.getElementById('answer');
const submitButton = document.getElementById('submit');
const resultContainer = document.getElementById('result');

// Function to use Text-to-Speech
function speak(text) {
    const speech = new SpeechSynthesisUtterance(text);
    speech.pitch = 1;
    speech.rate = 1;
    speech.volume = 1;
    speechSynthesis.speak(speech);
}

// Load the current question and speak it
function loadQuiz() {
    const currentQuizData = quizData[currentLevel][currentQuiz];
    quizContainer.innerHTML = `<p>Question ${currentQuiz + 1}:</p>`;
    speak(currentQuizData.question);
    submitButton.disabled = false;
}

// Handle answer submission
submitButton.addEventListener('click', async () => {
    const currentQuizData = quizData[currentLevel][currentQuiz];
    const userAnswer = answerInput.value.trim();

    if (userAnswer.toLowerCase() === currentQuizData.correct.toLowerCase()) {
        resultContainer.innerHTML = `<p class="correct">Correct!</p>`;
        score++;
    } else {
        resultContainer.innerHTML = `<p class="wrong">Wrong! The correct answer is: ${currentQuizData.correct}</p>`;
        
        try {
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer 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`, // Replace with your OpenAI API Key
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    model: 'gpt-3.5-turbo',
                    messages: [{ role: 'user', content: `Explain why the correct answer is: ${currentQuizData.correct}.` }],
                    max_tokens: 100
                })
            });

            const data = await response.json();
            const explanation = data.choices[0].message.content;
            
            // Display and speak the explanation
            resultContainer.innerHTML += `<p>${explanation}</p>`;
            speak(explanation); // Speak the explanation of the correct answer
        } catch (error) {
            console.error('Error fetching explanation:', error);
            resultContainer.innerHTML += `<p>Sorry, an error occurred while fetching the explanation.</p>`;
        }
    }

    currentQuiz++;
    answerInput.value = ''; // Clear input for next question

    if (currentQuiz < quizData[currentLevel].length) {
        setTimeout(() => {
            loadQuiz();
        }, 2000); // Move to next question after 2 seconds
    } else {
        setTimeout(() => {
            resultContainer.innerHTML += `<p>Your final score is: ${score}/${quizData[currentLevel].length}</p>`;
            submitButton.disabled = true; // Disable button after quiz ends
            speak(`Your final score is: ${score} out of ${quizData[currentLevel].length}`);
        }, 2000);
    }
});

// Set level based on button click
document.querySelectorAll('.level-btn').forEach(button => {
    button.addEventListener('click', () => {
        currentLevel = button.id; // Get the level from button id
        currentQuiz = 0; // Reset quiz
        score = 0; // Reset score
        resultContainer.innerHTML = ''; // Clear previous results
        loadQuiz(); // Load the first question of the selected level
    });
});

// Start quiz on page load
loadQuiz();
    </script>
</body>
</html>
