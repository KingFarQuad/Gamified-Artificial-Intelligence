<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Quiz Game</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
        };
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;700&display=swap');

        body {
            background-color: white;
            color: black;
            font-family: "DM Sans";
            transition: background-color 0.3s, color 0.3s;
        }

        .correct {
            background-color: #38a169;
            /* Green for correct answer */
            color: white;
        }

        .incorrect {
            background-color: #e53e3e;
            /* Red for incorrect answer */
            color: white;
        }
    </style>
</head>

<body class="bg-white dark:bg-gray-900 dark:text-white transition-all">
    <!-- Header -->
    <script>
        function backagain() {
            window.location.href = "./header.html";
        }
    </script>
    <header class="flex justify-between items-center p-4 bg-blue-500 dark:bg-blue-800">
        <h1 class="text-2xl font-bold">Quiz Game</h1>
        <div class="flex items-center">
            <button onclick="backagain()" class="mr-4 px-4 py-2 bg-gray-300 dark:bg-gray-600 text-black dark:text-white rounded">
                Back
            </button>
            <button id="theme-toggle" class="p-2 bg-white dark:bg-gray-700 rounded-full focus:outline-none">
                <svg id="sun-icon" class="hidden dark:block" stroke="currentColor" viewBox="0 0 16 16" height="28" width="28">
                    <path d="M8 0a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-1 0V.5A.5.5 0 0 1 8 0zm4.243 2.243a.5.5 0 0 1 .707 0l.707.707a.5.5 0 0 1-.707.707l-.707-.707a.5.5 0 0 1 0-.707zM16 8a.5.5 0 0 1-.5.5H15a.5.5 0 0 1 0-1h.5A.5.5 0 0 1 16 8zm-2.121 4.243a.5.5 0 0 1 0 .707l-.707.707a.5.5 0 0 1-.707-.707l.707-.707a.5.5 0 0 1 .707 0zM8 14a.5.5 0 0 1-.5.5v1a.5.5 0 0 1 1 0v-1A.5.5 0 0 1 8 14zm-5.121-2.121a.5.5 0 0 1 0 .707l-.707.707a.5.5 0 0 1-.707-.707l.707-.707a.5.5 0 0 1 .707 0zM0 8a.5.5 0 0 1 .5.5H1a.5.5 0 0 1 0-1H.5A.5.5 0 0 1 0 8zm2.121-4.243a.5.5 0 0 1 .707 0l.707.707a.5.5 0 0 1-.707.707l-.707-.707a.5.5 0 0 1 0-.707zM8 3a5 5 0 1 0 0 10 5 5 0 0 0 0-10z" />
                </svg>
                <svg id="moon-icon" class="block dark:hidden" stroke="currentColor" viewBox="0 0 16 16" height="28" width="28">
                    <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z" />
                </svg>
            </button>
        </div>
    </header>
    <div class="container mx-auto max-w-md p-6 bg-white rounded-lg shadow-lg mt-10">
        <h1 class="text-2xl font-bold text-center mb-6 text-black">Simple Quiz Game</h1>

        <div id="difficulty" class="mb-4">
            <span class="text-lg text-black">Select Difficulty:</span>
            <div class="flex space-x-4">
                <button id="easy" class="difficulty-btn bg-blue-500 text-white px-4 py-2 rounded">Easy</button>
                <button id="medium" class="difficulty-btn bg-yellow-500 text-white px-4 py-2 rounded">Medium</button>
                <button id="hard" class="difficulty-btn bg-red-500 text-white px-4 py-2 rounded">Hard</button>
            </div>
        </div>

        <div id="quiz" class="mb-4 text-black"></div>
        <button id="submit" class="w-full bg-green-500 text-white px-4 py-2 rounded hidden">Submit Answer</button>
        <div id="result" class="mt-4 text-black"></div>
    </div>

    <script>
        const themeToggleBtn = document.getElementById('theme-toggle');
        const htmlElement = document.documentElement;
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');

        // Set initial theme based on local storage
        if (localStorage.getItem('theme') === 'dark') {
            htmlElement.classList.add('dark');
        } else {
            htmlElement.classList.remove('dark');
        }

        // Toggle theme on button click
        themeToggleBtn.addEventListener('click', () => {
            if (htmlElement.classList.contains('dark')) {
                htmlElement.classList.remove('dark');
                localStorage.setItem('theme', 'light');
            } else {
                htmlElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
            }
            sunIcon.classList.toggle('hidden');
            moonIcon.classList.toggle('hidden');
        });

        const quizData = {
            easy: [
                {
                    question: "What is the capital city of the Philippines?",
                    options: ["A. Manila", "B. Quezon City", "C. Davao", "D. Cebu"],
                    correct: "A. Manila"
                },
                {
                    question: "Which planet is closest to the Sun?",
                    options: ["A. Venus", "B. Mercury", "C. Mars", "D. Earth"],
                    correct: "B. Mercury"
                },
                {
                    question: "What is 2 + 2?",
                    options: ["A. 3", "B. 4", "C. 5", "D. 6"],
                    correct: "B. 4"
                }
            ],
            medium: [
                {
                    question: "What is the largest ocean on Earth?",
                    options: ["A. Atlantic", "B. Indian", "C. Pacific", "D. Arctic"],
                    correct: "C. Pacific"
                },
                {
                    question: "Who wrote the play 'Hamlet'?",
                    options: ["A. Shakespeare", "B. Dickens", "C. Tolkien", "D. Austen"],
                    correct: "A. Shakespeare"
                },
                {
                    question: "What is the capital of Australia?",
                    options: ["A. Sydney", "B. Melbourne", "C. Canberra", "D. Brisbane"],
                    correct: "C. Canberra"
                }
            ],
            hard: [
                {
                    question: "What is the most spoken language in the world?",
                    options: ["A. English", "B. Mandarin", "C. Spanish", "D. Hindi"],
                    correct: "B. Mandarin"
                },
                {
                    question: "What year did World War II end?",
                    options: ["A. 1944", "B. 1945", "C. 1946", "D. 1947"],
                    correct: "B. 1945"
                },
                {
                    question: "Who painted the Mona Lisa?",
                    options: ["A. Van Gogh", "B. Da Vinci", "C. Picasso", "D. Rembrandt"],
                    correct: "B. Da Vinci"
                }
            ]
        };

        let currentQuestionIndex = 0;
let currentDifficulty = '';
let correctAnswersCount = 0; // To track correct answers

document.querySelectorAll('.difficulty-btn').forEach(button => {
    button.addEventListener('click', () => {
        currentDifficulty = button.id;
        currentQuestionIndex = 0;
        correctAnswersCount = 0; // Reset count when starting a new quiz
        document.getElementById('quiz').innerHTML = '';
        document.getElementById('result').innerHTML = '';
        showQuestion();
        document.getElementById('submit').classList.remove('hidden');
    });
});

function showQuestion() {
    if (currentQuestionIndex < quizData[currentDifficulty].length) {
        const questionData = quizData[currentDifficulty][currentQuestionIndex];
        const quizContainer = document.getElementById('quiz');
        quizContainer.innerHTML = `
            <div class="mb-4">
                <h2 class="text-lg font-bold">${questionData.question}</h2>
                <div class="mt-2">
                    ${questionData.options.map(option => `
                        <label class="block mt-2">
                            <input type="radio" name="answer" value="${option}" class="option-btn hidden peer" />
                            <div class="flex items-center border border-gray-300 rounded-lg p-2 my-1 cursor-pointer hover:bg-gray-100 peer-checked:bg-blue-500 peer-checked:text-white">
                                <div class="w-5 h-5 flex items-center justify-center mr-2 rounded-full border-2 border-gray-300 bg-white peer-checked:bg-blue-500">
                                    <div class="w-3 h-3 rounded-full bg-transparent peer-checked:bg-white"></div>
                                </div>
                                <span class="text-gray-800 peer-checked:text-white">${option}</span>
                            </div>
                        </label>
                    `).join('')}
                </div>
            </div>
        `;
    } else {
        document.getElementById('quiz').innerHTML = '<h2 class="text-lg font-bold">Quiz Completed!</h2>';
        document.getElementById('submit').classList.add('hidden');

        // Show total correct answers
        document.getElementById('result').innerHTML = `
            <div class="p-4 mt-4 bg-green-100 text-green-800 rounded-lg">
                <h3>Total Correct Answers: ${correctAnswersCount}/${quizData[currentDifficulty].length}</h3>
            </div>
        `;
    }
}

document.getElementById('submit').addEventListener('click', () => {
    const selectedOption = document.querySelector('input[name="answer"]:checked');
    if (selectedOption) {
        const userAnswer = selectedOption.value;
        const questionData = quizData[currentDifficulty][currentQuestionIndex];
        const resultDiv = document.getElementById('result');

        if (userAnswer === questionData.correct) {
            correctAnswersCount++; // Increment correct answer count
            resultDiv.innerHTML = `<div class="correct p-2">${questionData.correct} is correct!</div>`;
        } else {
            resultDiv.innerHTML = `<div class="incorrect p-2">${userAnswer} is incorrect. The correct answer is ${questionData.correct}.</div>`;
            // Fetch explanation from ChatGPT API (if needed)
            fetchChatGPTExplanation(questionData.correct);
        }
        currentQuestionIndex++;
        setTimeout(() => {
            resultDiv.innerHTML = '';
            showQuestion();
        }, 9000);
    } else {
        alert("Please select an answer!");
    }
});


        async function fetchChatGPTExplanation(correctAnswer) {
            const apiKey = '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'; // Replace with your actual OpenAI API key
            const prompt = `Explain why the correct answer is ${correctAnswer}.`;

            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: 'gpt-3.5-turbo',
                    messages: [{ role: 'user', content: prompt }]
                })
            });

            if (response.ok) {
                const data = await response.json();
                const explanation = data.choices[0].message.content;
                const explanationDiv = document.createElement('div');
                explanationDiv.classList.add('mt-4', 'p-2', 'bg-gray-200');
                explanationDiv.innerHTML = `<strong>Explanation:</strong> ${explanation}`;
                document.getElementById('result').appendChild(explanationDiv);
            } else {
                console.error('Error fetching explanation:', response.statusText);
            }
        }
    </script>
</body>

</html>
